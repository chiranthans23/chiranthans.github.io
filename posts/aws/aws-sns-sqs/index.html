<!doctype html><html><head><title>AWS SNS and SQS</title><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=x-ua-compatible content="ie=edge"><link rel=stylesheet href=/css/bootstrap.min.css><link rel=stylesheet href=/css/layouts/main.css><link rel=stylesheet href=/css/style.css><link rel=stylesheet href=/css/navigators/navbar.css><link href="https://fonts.googleapis.com/css2?family=Muli:wght@300;400;500;600" rel=stylesheet><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/all.min.css><link rel=icon type=image/png href=/images/sections/site/chiras-logo_hue4b36852387f98c20424375628d7006b_59865_42x0_resize_box_2.png><link rel=stylesheet href=/css/style.css><meta name=description content="AWS SNS and SQS"><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/styles/atom-one-dark.min.css><link rel=stylesheet href=/css/layouts/single.css><link rel=stylesheet href=/css/navigators/sidebar.css></head><body data-spy=scroll data-target=#TableOfContents data-offset=80><div class="container-fluid bg-dimmed wrapper"><nav class="navbar navbar-expand-xl top-navbar final-navbar shadow"><div class=container><button class="navbar-toggler navbar-light" id=sidebar-toggler type=button onclick=toggleSidebar()>
<span class=navbar-toggler-icon></span></button>
<a class=navbar-brand href=/><img src=/images/sections/site/chiras-logo_hue4b36852387f98c20424375628d7006b_59865_42x0_resize_box_2.png>Chiranthan's Blog</a>
<button class="navbar-toggler navbar-light" id=toc-toggler type=button onclick=toggleTOC()>
<span class=navbar-toggler-icon></span></button><div class="collapse navbar-collapse lang-selector" id=top-nav-items><ul class="navbar-nav ml-auto"></ul></div></div><img src=/images/sections/site/chiras-logo_hue4b36852387f98c20424375628d7006b_59865_42x0_resize_box_2.png class=d-none id=main-logo>
<img src=/images/sections/site/chiras-logo_hue4b36852387f98c20424375628d7006b_59865_42x0_resize_box_2.png class=d-none id=inverted-logo></nav><section class=sidebar-section id=sidebar-section><div class=sidebar-holder><div class=sidebar id=sidebar><input type=text placeholder=Search id=search-box><div class=sidebar-tree><ul class=tree id=tree><li id=list-heading><a href=/posts data-filter=all>Posts</a></li><div class=subtree><li><i class="fas fa-minus-circle"></i><a class=active href=/posts/aws/>AWS</a><ul class=active><li><a href=/posts/aws/aws-cm/>AWS Certificate Manager</a></li><li><a href=/posts/aws/aws-cloudfront/>AWS Cloudfront</a></li><li><a href=/posts/aws/aws-dynamodb/>AWS DynamoDB</a></li><li><a href=/posts/aws/aws-ecs/>AWS ECS</a></li><li><a href=/posts/aws/aws-eks/>AWS EKS</a></li><li><a href=/posts/aws/aws-route53/>AWS Route53</a></li><li><a href=/posts/aws/aws-s3/>AWS S3</a></li><li><a class=active href=/posts/aws/aws-sns-sqs/>AWS SNS and SQS</a></li><li><a href=/posts/aws/aws-vpc/>AWS VPC Fundamentals</a></li></ul></li><li><i class="fas fa-plus-circle"></i><a href=/posts/general/>General</a><ul><li><a href=/posts/general/stay-strong/>Staying strong in life</a></li></ul></li></div></ul></div></div></div></section><section class=content-section id=content-section><div class=content><div class="container p-0 read-area"><div class="hero-area col-sm-12" id=hero-area style=background-image:url(https://blog.chiranthans23.com/posts/aws/aws-sns-sqs/hero.png)></div><div class=page-content><div class="author-profile ml-auto align-self-lg-center"><img class=rounded-circle src=/images/sections/site/chiras-picture.png><h5 class=author-name>Chiranthan S</h5><p>March 4, 2021</p></div><div class=title><h1>AWS SNS and SQS</h1></div><div class=post-content id=post-content><h1 id=aws-sns-and-sqs>AWS SNS and SQS</h1><h2 id=overview>Overview</h2><ul><li>AWS service that helps in decoupling the applications and still communicate</li><li>Unlimited throughput, message stays for 4-14 days in the queue</li><li>Has a producer and a consumer</li></ul><h2 id=sqs-with-asg>SQS with ASG</h2><ul><li>Can setup CloudWatch alarm to check on the number of messages in the queue and based on that scale up or down, the number of consumers</li></ul><h2 id=create-a-queue>Create a Queue</h2><ul><li>Management Console-> SQS-> Create Queue</li><li>We can add messages and when polled, messages will appear in the queue</li><li>Deleting the message signals that it&rsquo;s been read</li></ul><h2 id=message-visibility-timeout>Message visibility timeout</h2><ul><li>Time given for a consumer to process a message. While it&rsquo;s being processed, the message won&rsquo;t be visible in the queue</li></ul><h2 id=dead-letter-queue>Dead letter queue</h2><ul><li>If the time taken to process a message crosses the max time(visibility timeout), and if it happens multiple times(the number can be set), we can tell the SQS to move it to the Dead letter queue. This will help in debugging the message later.</li><li>Create another queue-> Go back to the previous queueu and, enable DLQ-> provide the queue for DLQ name</li></ul><h2 id=message-delay>Message delay</h2><ul><li>Queues also provide the option to set the delay time for messages- how long the messages have to be held within queue, before the consumers are able to read them</li><li>Can be overwridden at message level</li></ul><h2 id=long-polling>Long Polling</h2><ul><li>When there are no messages in the queue, the consumers can be made to wait for a set time, instead of polling repeatedly. This improves efficiency of the application</li><li>This can be set at the queue level, using <code>WaitTimeSeconds</code></li></ul><h2 id=aws-extended-client>AWS extended client</h2><ul><li>It is helpful if we want to send large messages, >256kb</li><li>We can use AWS extended client for this</li><li>We can send the larger message to S3 bucket, while only sending small message(metadata) to the SQS, similarly, using metadata consumer fetches the larget message from the S3</li></ul><h2 id=aws-sqs-fifo>AWS SQS FIFO</h2><ul><li>As the name says, it processes the message in FIFO order</li><li>The consumer recieves messages in the same order as sent by the producer</li></ul><h2 id=sqs-deduplication>SQS DeDuplication</h2><ul><li>With this in a <strong>5 mins interval</strong>, we can make sure, same message doesn&rsquo;t come to the queue multiple times</li><li>5 mins is the deduplication time</li><li>Deduplication check is done in two ways<ul><li>SHA of the body of the message is checked</li><li>Deduplication ID is checked</li></ul></li></ul><h2 id=sqs-message-grouping>SQS Message grouping</h2><ul><li>Only one consumer can be placed for one groupID</li><li>Using GroupID, we can consolidate messages into different groups</li><li>In this way, multiple consumers can consume messages parallely</li><li>FIFO is not maintained among groups</li></ul><h2 id=sns-overview>SNS Overview</h2><ul><li>Amazon SNS is similar to SQS, but in this case, there can be more than one recievers</li><li>By using Topics, many subscribers can receive same message</li><li>AWS support 10^5 topics and 10^5 subscribers</li><li>Subscibers can be SQS, HTTPS, Lambda, etc</li><li>Supports Security similar to SQS, KMS for at-rest encryption and HTTPS for in-flight</li></ul><h2 id=create-a-topic>Create a topic</h2><ul><li>SNS-> create topic-> create subcription</li></ul><h2 id=fan-out>Fan-out</h2><ul><li>A SNS topic can send message to multiple SQS queues</li><li>With this applications can be decoupled and additionally, the messages can be delayed, persisted and etc, by the features of SQS</li><li>A noteworthy point is that, currently, SNS topic cannot send messages to FIFO SQS queue</li></ul><h2 id=lambda-as-a-subscriber>Lambda as a subscriber</h2><ul><li>Create a lambda that can be called async</li><li>make it as a subscriber to a sns topic, for e.g</li><li>when a message is sent to sns topic, it should be seen in cloudwatch logs</li><li>lambda can be called by invoking from cli too</li><li>for e.g</li></ul><pre><code class="language-shell=" data-lang="shell=">aws lambda invoke --function-name chiras-sns-handling-lambda --cli-binary-format raw-in-base64-out --payload '   {
        &quot;Message&quot;: &quot; chiras example message&quot;
    }' --invocation-type Event --region ap-south-1 response.json
</code></pre></div><div class=btn-improve-page><a href=https://github.com/chiranthans23/chiranthans23.github.io/edit/master/content/posts/aws/aws-sns-sqs/index.md><i class="fas fa-code-branch"></i>Improve this page</a></div><hr><div class="row next-prev-navigator"><div class="col-md-6 previous-article"><a href=/posts/general/stay-strong/ class="btn btn-outline-info"><span><i class="fas fa-chevron-circle-left"></i>Prev</span><br><span>Staying strong in life</span></a></div><div class="col-md-6 next-article"><a href=/posts/aws/aws-ecs/ class="btn btn-outline-info"><span>Next <i class="fas fa-chevron-circle-right"></i></span><br><span>AWS ECS</span></a></div></div><hr></div></div></div></section><section class=toc-section id=toc-section><div class=toc-holder><h5 class="text-center pl-3">Table of Contents</h5><hr><div class=toc><nav id=TableOfContents><ul><li><a href=#overview>Overview</a></li><li><a href=#sqs-with-asg>SQS with ASG</a></li><li><a href=#create-a-queue>Create a Queue</a></li><li><a href=#message-visibility-timeout>Message visibility timeout</a></li><li><a href=#dead-letter-queue>Dead letter queue</a></li><li><a href=#message-delay>Message delay</a></li><li><a href=#long-polling>Long Polling</a></li><li><a href=#aws-extended-client>AWS extended client</a></li><li><a href=#aws-sqs-fifo>AWS SQS FIFO</a></li><li><a href=#sqs-deduplication>SQS DeDuplication</a></li><li><a href=#sqs-message-grouping>SQS Message grouping</a></li><li><a href=#sns-overview>SNS Overview</a></li><li><a href=#create-a-topic>Create a topic</a></li><li><a href=#fan-out>Fan-out</a></li><li><a href=#lambda-as-a-subscriber>Lambda as a subscriber</a></li></ul></nav></div></div></section></div><footer class="container-fluid text-center align-content-center footer pb-2"><div class="container pt-5"><div class="row text-left"><div class="col-md-4 col-sm-12"><h5>Navigation</h5><ul><li class=nav-item><a class=smooth-scroll href=#about>About</a></li><li class=nav-item><a class=smooth-scroll href=#skills>Skills</a></li><li class=nav-item><a class=smooth-scroll href=#experiences>Experiences</a></li><li class=nav-item><a class=smooth-scroll href=#education>Education</a></li><li class=nav-item><a class=smooth-scroll href=#projects>Projects</a></li></ul></div><div class="col-md-4 col-sm-12"><h5>Contact me:</h5><ul><li><span>Email:</span> <span>chiranthans23@gmail.com</span></li><li><span>Phone:</span> <span>+919535179196</span></li></ul></div></div></div><hr></footer><script src=/js/jquery-3.4.1.min.js></script><script src=/js/popper.min.js></script><script src=/js/bootstrap.min.js></script><script src=/js/navbar.js></script><script src=/js/main.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/highlight.min.js></script><script src=/js/single.js></script><script>hljs.initHighlightingOnLoad();</script></body></html>