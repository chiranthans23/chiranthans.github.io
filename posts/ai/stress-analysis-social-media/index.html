<!doctype html><html><head><title>Stress analysis on Social media</title><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=x-ua-compatible content="ie=edge"><link rel=stylesheet href=/css/bootstrap.min.css><link rel=stylesheet href=/css/layouts/main.css><link rel=stylesheet href=/css/style.css><link rel=stylesheet href=/css/navigators/navbar.css><link href="https://fonts.googleapis.com/css2?family=Muli:wght@300;400;500;600" rel=stylesheet><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/all.min.css><link rel=icon type=image/png href=/images/sections/site/chiras-logo_hue4b36852387f98c20424375628d7006b_59865_42x0_resize_box_2.png><link rel=stylesheet href=/css/style.css><meta name=description content="Stress analysis on Social media"><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/styles/atom-one-dark.min.css><link rel=stylesheet href=/css/layouts/single.css><link rel=stylesheet href=/css/navigators/sidebar.css></head><body data-spy=scroll data-target=#TableOfContents data-offset=80><div class="container-fluid bg-dimmed wrapper"><nav class="navbar navbar-expand-xl top-navbar final-navbar shadow"><div class=container><button class="navbar-toggler navbar-light" id=sidebar-toggler type=button onclick=toggleSidebar()>
<span class=navbar-toggler-icon></span></button>
<a class=navbar-brand href=/><img src=/images/sections/site/chiras-logo_hue4b36852387f98c20424375628d7006b_59865_42x0_resize_box_2.png>Chiranthan's Blog</a>
<button class="navbar-toggler navbar-light" id=toc-toggler type=button onclick=toggleTOC()>
<span class=navbar-toggler-icon></span></button><div class="collapse navbar-collapse lang-selector" id=top-nav-items><ul class="navbar-nav ml-auto"></ul></div></div><img src=/images/sections/site/chiras-logo_hue4b36852387f98c20424375628d7006b_59865_42x0_resize_box_2.png class=d-none id=main-logo>
<img src=/images/sections/site/chiras-logo_hue4b36852387f98c20424375628d7006b_59865_42x0_resize_box_2.png class=d-none id=inverted-logo></nav><section class=sidebar-section id=sidebar-section><div class=sidebar-holder><div class=sidebar id=sidebar><input type=text placeholder=Search id=search-box><div class=sidebar-tree><ul class=tree id=tree><li id=list-heading><a href=/posts data-filter=all>Posts</a></li><div class=subtree><li><i class="fas fa-minus-circle"></i><a class=active href=/posts/ai/>AI</a><ul class=active><li><a class=active href=/posts/ai/stress-analysis-social-media/>Stress analysis on Social media</a></li></ul></li><li><i class="fas fa-plus-circle"></i><a href=/posts/aws/>AWS</a><ul><li><a href=/posts/aws/aws-cm/>AWS Certificate Manager</a></li><li><a href=/posts/aws/aws-cloudfront/>AWS Cloudfront</a></li><li><a href=/posts/aws/aws-dynamodb/>AWS DynamoDB</a></li><li><a href=/posts/aws/aws-ecs/>AWS ECS</a></li><li><a href=/posts/aws/aws-eks/>AWS EKS</a></li><li><a href=/posts/aws/aws-route53/>AWS Route53</a></li><li><a href=/posts/aws/aws-s3/>AWS S3</a></li><li><a href=/posts/aws/aws-sns-sqs/>AWS SNS and SQS</a></li><li><a href=/posts/aws/aws-vpc/>AWS VPC Fundamentals</a></li></ul></li><li><a href=/posts/general/>General</a></li></div></ul></div></div></div></section><section class=content-section id=content-section><div class=content><div class="container p-0 read-area"><div class="hero-area col-sm-12" id=hero-area style=background-image:url(https://blog.chiranthans23.com/posts/ai/stress-analysis-social-media/hero.jpg)></div><div class=page-content><div class="author-profile ml-auto align-self-lg-center"><img class=rounded-circle src=/images/sections/site/chiras-picture.png><h5 class=author-name>Chiranthan S</h5><p>September 4, 2021</p></div><div class=title><h1>Stress analysis on Social media</h1></div><div class=post-content id=post-content><h1 id=resources>Resources</h1><ul><li>Code: <a href=https://github.com/chiranthans23/stress-analysis-social-media>https://github.com/chiranthans23/stress-analysis-social-media</a></li><li>Train and test data: dreaddit-train.csv, dreaddit-test.csv</li><li>EDA report: report.html</li></ul><h2 id=introduction>Introduction</h2><p>This is a work on <a href="https://arxiv.org/abs/1911.00133?utm_source=feedburner&utm_medium=feed&utm_campaign=Feed%253A+arxiv%252FQSXk+%2528ExcitingAds%2521+cs+updates+on+arXiv.org%2529">Dreaddit dataset</a> taken from one of latest datasets on <a href=https://www.kaggle.com/ruchi798/stress-analysis-in-social-media>Kaggle</a> bwhich is created using data from 5 different Reddit communities. This is a slightly different problem as the length of the posts are larger than the usual tweets. Additionally, the data available for training is also not quite huge.</p><h2 id=first-look>First look</h2><p>This work doesn&rsquo;t really have a extensive EDA, but just looks at the dataset - columns, amount of data available, missing values. This is done using Pandas profiling. Pandas profiling does very good Auto EDA and gives myriad of information. Minimal data can also be seen by using the <code>minimal</code> param.</p><blockquote><p>Code: pre-processor.ipynb</p></blockquote><h2 id=pre-processing>Pre-processing</h2><p>Firstly, few uncessary columns such as the post_id, sentence_range is removed. Second, the subreddit category - a categorical data - is <em>OneHotEncoded</em>. Helper functions are run on the text of posts to clean them. <em>BERT base uncased</em> tokenizer from :hugging_face: is used to tokenize the text data. Finally the pre-processed data is written to file.</p><blockquote><p>Code: pre-processor.ipynb</p></blockquote><h2 id=model-evaluation>Model evaluation</h2><p>Multiple models were used for evaluation - XGBoost, SVM, Random Forest, LightGBM, GBM, etc. <code>cross_value_score</code> and 10-fold was used for evaluating the models. This roughly gave an idea of the weak and strong models. For this section, I took help from <a href=https://www.kaggle.com/sohommajumder21/bert-tokenizer-with-9-models-nlp-stress-analysis>this</a> notebook.</p><blockquote><p>Code: model.ipynb</p></blockquote><h2 id=hyperparameter-optimization>Hyperparameter optimization</h2><p>Models XGBoost, LGBM, and GBM which gave almost same results were optimized. A beautiful framework <a href=https://optuna.org/>Optuna</a> was used for this. I have used 100 trials for optimization and best parameters of each model is captured in different files. This is a time-consuming process, so using GPU will help in speeding up the process.</p><blockquote><p>Code: xgboost_optimization.ipynb
Code: lgbm_optimization.ipynb
Code: gbm_optimization.ipynb</p></blockquote><h2 id=final-model>Final model</h2><p>The best parameters from the optimization step still resulted in almost same overall score of all the above models. Hence, a stable model was built by ensembling the best XGBoost, LGBM, GBM models using Voting classifier. This resulted in F1 score of around 0.77.</p><blockquote><p>Code: main.ipynb</p></blockquote></div><div class=btn-improve-page><a href=https://github.com/chiranthans23/chiranthans23.github.io/edit/master/content/posts/AI/stress-analysis-social-media/index.md><i class="fas fa-code-branch"></i>Improve this page</a></div><hr><div class="row next-prev-navigator"><div class="col-md-12 next-article"><a href=/posts/aws/aws-dynamodb/ class="btn btn-outline-info"><span>Next <i class="fas fa-chevron-circle-right"></i></span><br><span>AWS DynamoDB</span></a></div></div><hr></div></div></div></section><section class=toc-section id=toc-section><div class=toc-holder><h5 class="text-center pl-3">Table of Contents</h5><hr><div class=toc><nav id=TableOfContents><ul><li><a href=#introduction>Introduction</a></li><li><a href=#first-look>First look</a></li><li><a href=#pre-processing>Pre-processing</a></li><li><a href=#model-evaluation>Model evaluation</a></li><li><a href=#hyperparameter-optimization>Hyperparameter optimization</a></li><li><a href=#final-model>Final model</a></li></ul></nav></div></div></section></div><footer class="container-fluid text-center align-content-center footer pb-2"><div class="container pt-5"><div class="row text-left"><div class="col-md-4 col-sm-12"><h5>Navigation</h5><ul><li class=nav-item><a class=smooth-scroll href=#about>About</a></li><li class=nav-item><a class=smooth-scroll href=#skills>Skills</a></li><li class=nav-item><a class=smooth-scroll href=#experiences>Experiences</a></li><li class=nav-item><a class=smooth-scroll href=#education>Education</a></li><li class=nav-item><a class=smooth-scroll href=#projects>Projects</a></li></ul></div><div class="col-md-4 col-sm-12"><h5>Contact me:</h5><ul><li><span>Email:</span> <span>chiranthans23@gmail.com</span></li><li><span>Phone:</span> <span>+919535179196</span></li></ul></div></div></div><hr></footer><script src=/js/jquery-3.4.1.min.js></script><script src=/js/popper.min.js></script><script src=/js/bootstrap.min.js></script><script src=/js/navbar.js></script><script src=/js/main.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/highlight.min.js></script><script src=/js/single.js></script><script>hljs.initHighlightingOnLoad();</script></body></html>